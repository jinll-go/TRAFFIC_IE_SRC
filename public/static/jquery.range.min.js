(function(t,i,s,e){"use strict";var o=function(){return this.init.apply(this,arguments)};o.prototype={defaults:{onstatechange:function(){},isRange:false,showLabels:true,showScale:true,step:1,format:"%s",theme:"theme-green",width:300,disable:false},template:'<div class="slider-container">\t\t\t<div class="back-bar">                <div class="selected-bar"></div>                <div class="pointer low"></div><div class="pointer-label">123456</div>                <div class="pointer high"></div><div class="pointer-label">456789</div>                <div class="clickable-dummy"></div>            </div>            <div class="scale"></div>\t\t</div>',init:function(i,s){this.options=t.extend({},this.defaults,s);this.inputNode=t(i);this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:this.options.from);this.domNode=t(this.template);this.domNode.addClass(this.options.theme);this.inputNode.after(this.domNode);this.domNode.on("change",this.onChange);this.pointers=t(".pointer",this.domNode);this.lowPointer=this.pointers.first();this.highPointer=this.pointers.last();this.labels=t(".pointer-label",this.domNode);this.lowLabel=this.labels.first();this.highLabel=this.labels.last();this.scale=t(".scale",this.domNode);this.bar=t(".selected-bar",this.domNode);this.clickableBar=this.domNode.find(".clickable-dummy");this.interval=this.options.to-this.options.from;this.valueChangeCb=this.options.valueChangeCb;this.render()},render:function(){if(this.inputNode.width()===0&&!this.options.width){if(i.console)console.log("jRange : no width found, returning");return}else{this.domNode.width(this.options.width||this.inputNode.width());this.inputNode.hide()}if(this.isSingle()){this.lowPointer.hide();this.lowLabel.hide()}if(!this.options.showLabels){this.labels.hide()}this.attachEvents();if(this.options.showScale){this.renderScale()}this.setValue(this.options.value)},isSingle:function(){if(typeof this.options.value==="number"){return true}return this.options.value.indexOf(",")!==-1||this.options.isRange?false:true},attachEvents:function(){this.clickableBar.click(t.proxy(this.barClicked,this));this.pointers.on("mousedown touchstart",t.proxy(this.onDragStart,this));this.pointers.bind("dragstart",function(t){t.preventDefault()})},onDragStart:function(i){if(this.options.disable||i.type==="mousedown"&&i.which!==1){return}i.stopPropagation();i.preventDefault();var e=t(i.target);this.pointers.removeClass("last-active");e.addClass("focused last-active");this[(e.hasClass("low")?"low":"high")+"Label"].addClass("focused");t(s).on("mousemove.slider touchmove.slider",t.proxy(this.onDrag,this,e));t(s).on("mouseup.slider touchend.slider touchcancel.slider",t.proxy(this.onDragEnd,this))},onDrag:function(t,i){i.stopPropagation();i.preventDefault();if(i.originalEvent.touches&&i.originalEvent.touches.length){i=i.originalEvent.touches[0]}else if(i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length){i=i.originalEvent.changedTouches[0]}var s=i.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,t,s])},onDragEnd:function(i){this.pointers.removeClass("focused");this.labels.removeClass("focused");t(s).off(".slider")},barClicked:function(t){if(this.options.disable)return;var i=t.pageX-this.clickableBar.offset().left;if(this.isSingle())this.setPosition(this.pointers.last(),i,true,true);else{var s=Math.abs(parseInt(this.pointers.first().css("left"),10)-i+this.pointers.first().width()/2)<Math.abs(parseInt(this.pointers.last().css("left"),10)-i+this.pointers.first().width()/2)?this.pointers.first():this.pointers.last();this.setPosition(s,i,true,true)}},onChange:function(t,i,s,e){var o,n;if(i.isSingle()){o=0;n=i.domNode.width()}else{o=s.hasClass("high")?i.lowPointer.position().left+i.lowPointer.width()/2:0;n=s.hasClass("low")?i.highPointer.position().left+i.highPointer.width()/2:i.domNode.width()}var h=Math.min(Math.max(e,o),n);i.setPosition(s,h,true)},setPosition:function(t,i,s,e){var o,n=this.lowPointer.position().left,h=this.highPointer.position().left,a=this.highPointer.width()/2;if(!s){i=this.prcToPx(i)}if(t[0]===this.highPointer[0]){h=Math.round(i-a)}else{n=Math.round(i-a)}t[e?"animate":"css"]({left:Math.round(i-a)});if(this.isSingle()){o=0}else{o=n+a}this.bar[e?"animate":"css"]({width:Math.round(h+a-o),left:o});this.showPointerValue(t,i,e);this.isReadonly()},setValue:function(t){var i=t.toString().split(",");this.options.value=t;var s=this.valuesToPrc(i.length===2?i:[0,i[0]]);if(this.isSingle()){this.setPosition(this.highPointer,s[1])}else{this.setPosition(this.lowPointer,s[0]);this.setPosition(this.highPointer,s[1])}},renderScale:function(){var i=this.options.scale||[this.options.from,this.options.to];var s=Math.round(100/(i.length-1)*10)/10;var e="";for(var o=0;o<i.length;o++){e+='<span style="left: '+o*s+'%">'+(i[o]!="|"?"<ins>"+i[o]+"</ins>":"")+"</span>"}this.scale.html(e);t("ins",this.scale).each(function(){t(this).css({marginLeft:-t(this).outerWidth()/2})})},getBarWidth:function(){var t=this.options.value.split(",");if(t.length>1){return parseInt(t[1],10)-parseInt(t[0],10)}else{return parseInt(t[0],10)}},showPointerValue:function(i,s,o){var n=t(".pointer-label",this.domNode)[i.hasClass("low")?"first":"last"]();var h;var a=this.positionToValue(s);if(t.isFunction(this.options.format)){var l=this.isSingle()?e:i.hasClass("low")?"low":"high";h=this.options.format(a,l)}else{h=this.options.format.replace("%s",a)}var r=n.html(h).width(),d=s-r/2;d=Math.min(Math.max(d,0),this.options.width-r);n[o?"animate":"css"]({left:d});this.setInputValue(i,a)},valuesToPrc:function(t){var i=(t[0]-this.options.from)*100/this.interval,s=(t[1]-this.options.from)*100/this.interval;return[i,s]},prcToPx:function(t){return this.domNode.width()*t/100},positionToValue:function(t){var i=t/this.domNode.width()*this.interval;i=i+this.options.from;return Math.round(i/this.options.step)*this.options.step},setInputValue:function(t,i){if(this.isSingle()){this.options.value=i.toString()}else{var s=this.options.value.split(",");if(t.hasClass("low")){this.options.value=i+","+s[1]}else{this.options.value=s[0]+","+i}}if(this.inputNode.val()!==this.options.value){this.inputNode.val(this.options.value);this.options.onstatechange.call(this,this.options.value);this.valueChangeCb(i)}},getValue:function(){return this.options.value},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=true;this.isReadonly()},enable:function(){this.options.disable=false;this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable;this.isReadonly()}};var n="jRange";t.fn[n]=function(s){var e=arguments,h;this.each(function(){var a=t(this),l=t.data(this,"plugin_"+n),r=typeof s==="object"&&s;if(!l){a.data("plugin_"+n,l=new o(this,r));t(i).resize(function(){l.setValue(l.getValue())})}if(typeof s==="string"){h=l[s].apply(l,Array.prototype.slice.call(e,1))}});return h||this}})(jQuery,window,document);