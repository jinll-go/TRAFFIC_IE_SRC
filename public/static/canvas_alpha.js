!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.CVCanvasDraw=i():t.CVCanvasDraw=i()}(this,(function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var h=i[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,e),h.l=!0,h.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var h in t)e.d(s,h,function(i){return t[i]}.bind(null,h));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";function s(t){t+=60*(new Date).getTimezoneOffset();let i=new Date(1e3*t);return{year:i.getFullYear(),Month:i.getMonth()+1,day:i.getDate(),hour:i.getHours(),min:i.getMinutes(),sec:i.getSeconds()}}function h(t){if("object"!=typeof t)return t;let i=Array.isArray(t)?[]:{};if(Array.isArray(t))return r(t);if(t&&"object"==typeof t)for(let e in t)t.hasOwnProperty(e)&&(t[e]&&"object"==typeof t[e]?i[e]=h(t[e]):i[e]=t[e]);return i}function r(t){let i=[],e=0,s=t.length;for(;e<s;e++)t[e]instanceof Array?i[e]=r(t[e]):i[e]=t[e];return i}function o(t){return t<10?"0"+t:t}e.r(i);class n{constructor(t,i,e){this.defaultConfig={brushColor:"red",font:"10px Arial",width:0,height:0,bgColor:"black",showActiveOnly:!1},this.oldWidth=t,this.oldHeight=i,this.AttributesListener(this,t,"width",()=>{this.Restore()}),this.AttributesListener(this,i,"height",()=>{this.Restore()}),this.AttributesListener(this,"red","color",()=>{this.Restore()}),this.AttributesListener(this,"black","bgColor",()=>{this.Restore()}),this.AttributesListener(this,0,"rotation",()=>{this.Restore()}),"[object String]"==Object.prototype.toString.call(e)?(e.startsWith("#")||(e="#"+e),this.c=document.querySelector(e)):"[object HTMLCanvasElement]"==Object.prototype.toString.call(e)?this.c=e:this.c=null,this.c&&(this.c.width=this.width,this.c.height=this.height,this.ctx=this.c.getContext("2d")),this.c&&(this.ctx=this.c.getContext("2d"))}Check_width(t){return!0}AttributesListener(t,i,e,s){let r=h(i),o=h(i);Object.defineProperty(t,e,{get:()=>o,set:t=>{o!=t&&(!this["Check_"+e]||this["Check_"+e](t)?(o=h(t),s(!0)):(o=h(r),s(!1)))}})}Restore(){this.c.height=this.height,this.c.width=this.width,this.DrawFillRect(0,0,this.width,this.height,this.bgColor)}Init(){this.c.oncontextmenu=function(){return!1},this.Restore(),this.c.onmousedown=t=>{this.MouseDown(t)},this.c.onmousemove=t=>{this.MouseMove(t)},this.c.onmouseup=t=>{this.MouseUp(t)},this.c.onmouseleave=t=>{this.MouseLeave(t)},this.remove_wheel=function(t,i,e=!1){var s,h,r,o="";function n(t,i,e,h){t[s](o+i,"wheel"==r?e:function(t){!t&&(t=window.event);var i={originalEvent:t,target:t.target||t.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){t.preventDefault?t.preventDefault():t.returnValue=!1}};return"mousewheel"==r?(i.deltaY=-1/40*t.wheelDelta,t.wheelDeltaX&&(i.deltaX=-1/40*t.wheelDeltaX)):i.deltaY=t.detail,e(i)},h||!1)}return window.addEventListener?(s="addEventListener",h="removeEventListener"):(s="attachEvent",h="detachEvent",o="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",n(t,r,i,e),"DOMMouseScroll"==r&&n(t,"MozMousePixelScroll",i,e),function(){t[h](r,i)}}(this.c,t=>{this.MouseWheel(t)}),this.c.ondblclick=t=>{this.DoubleClick(t)}}MouseDown(t){}MouseMove(t){}MouseUp(t){}MouseLeave(t){}DoubleClick(t){}MouseWheel(t){}Destroy(){this.c.oncontextmenu=null,this.c.onmousedown=null,this.c.onmousemove=null,this.c.onmouseup=null,this.c.onmouseleave=null,this.c.ondblclick=null,this.remove_wheel(),this.c=null}OverflowDetail(t,i=0){let e=t[0],s=t[1];return e<0+i&&(e=0+i),e>this.width-i&&(e=this.width-i),s<0+i&&(s=0+i),s>this.height-i&&(s=this.height-i),[e,s]}DrawLine(t,i,e,s,h=this.color){this.ctx.strokeStyle=h,this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.lineTo(e,s),this.ctx.stroke()}DrawRect(t,i,e,s,h=this.color){this.ctx.strokeStyle=h,this.ctx.strokeRect(t,i,e,s)}DrawRect_Dotted(t,i,e,s,h=this.color){this.ctx.strokeStyle=h,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(t,i,e,s),this.ctx.setLineDash([])}DrawFillRect(t,i,e,s,h=this.color){this.ctx.fillStyle=h,this.ctx.fillRect(t,i,e,s)}MeasureText(t,i=this.ctx.font){let e=this.ctx.font;this.ctx.font=i;let s=this.ctx.measureText(t);return this.ctx.font=e,s}DrawText(t,i,e,s=this.defaultConfig.font,h=this.color){this.ctx.font=s,this.ctx.strokeStyle=h,this.ctx.strokeText(e,t,i)}DrawFillText(t,i,e,s=this.defaultConfig.font,h=this.color){this.ctx.font=s,this.ctx.fillStyle=h,this.ctx.textAlign="start",this.ctx.textBaseline="top",this.ctx.fillText(e,t,i)}DrawArrow(t,i,e,s,h=30,r=10,o=1,n=!1,a="#000"){let l=180*Math.atan2(i-s,t-e)/Math.PI,c=(l+h)*Math.PI/180,f=(l-h)*Math.PI/180,u=r*Math.cos(c),w=r*Math.sin(c),_=r*Math.cos(f),x=r*Math.sin(f);this.ctx.save(),this.ctx.beginPath();let d=t-u,p=i-w;n&&(this.ctx.moveTo(d,p),this.ctx.lineTo(t,i),d=t-_,p=i-x,this.ctx.lineTo(d,p)),this.ctx.moveTo(t,i),this.ctx.lineTo(e,s),d=e+u,p=s+w,this.ctx.moveTo(d,p),this.ctx.lineTo(e,s),d=e+_,p=s+x,this.ctx.lineTo(d,p),this.ctx.strokeStyle=a,this.ctx.lineWidth=o,this.ctx.stroke(),this.ctx.restore()}Get_AB_point(t){if(t.length<2)return[[0,0],[0,0]];let i=0,e=[0,0],s=[0,0];for(let h=1;h<t.length;h++){let r=Math.pow(t[h][0]-t[h-1][0],2)+Math.pow(t[h][1]-t[h-1][1],2);r>i&&(i=r,e=Object.assign([],t[h]),s=Object.assign([],t[h-1]))}if(0==i)return;let h=[0,0];h[0]=(e[0]+s[0])/2,h[1]=(e[1]+s[1])/2;let r=s[0]-e[0],o=s[1]-e[1],n=[0,0];n[0]=Math.round(h[0]-.5*Math.sqrt(Math.pow(128,2)/(1+Math.pow(-r/o,2)))),n[1]=Math.round(-r/o*n[0]+h[1]+r/o*h[0]);let a=[0,0];return a[0]=Math.round(.5*Math.sqrt(Math.pow(128,2)/(1+Math.pow(-r/o,2)))+h[0]),a[1]=Math.round(-r/o*a[0]+h[1]+r/o*h[0]),n=this.OverflowDetail(n),a=this.OverflowDetail(a),[n,a]}GetCenterPoint(t){let i=0,e=0,s=t.length,h=0,r=0;if(s<3)return[0,0];for(let o=0;o<s-1;o++)i=t[o][0]*t[o+1][1]-t[o][1]*t[o+1][0],e+=i,h+=i*(t[o][0]+t[o+1][0]),r+=i*(t[o][1]+t[o+1][1]);return i=t[s-1][0]*t[0][1]-t[s-1][1]*t[0][0],e+=i,h+=i*(t[s-1][0]+t[0][0]),r+=i*(t[s-1][1]+t[0][1]),e/=2,h=Math.round(h/(6*e)),r=Math.round(r/(6*e)),[h,r]=this.OverflowDetail([h,r]),[h,r]}DrawArc(t,i,e,s,h,r,o,n=!0){n?(this.ctx.fillStyle=o,this.ctx.beginPath(),this.ctx.arc(t,i,e,s,h,r),this.ctx.closePath(),this.ctx.fill()):(this.ctx.strokeStyle=o,this.ctx.beginPath(),this.ctx.arc(t,i,e,s,h,r),this.ctx.stroke())}}const a={0:"rgb(0,0,255)",1:"rgb(213,205,98)",2:"rgb(206,75,29)",3:"rgb(215,129,190)",4:"rgb(172,219,245)",5:"rgb(82,120,99)",6:"rgb(0,255,0)",8:"rgb(204,232,207)"};class l extends n{constructor(t,i,e){super(t,i,e),this.active_idx=0,this.all_lines=[],this.isStartPaint=!1,this.pointArr=[],this._pointArr=[],this.pointNum=5,this.pointArr_offset=0,this.scale=0,this.AttributesListener(this,[],"all_lines",t=>{this.getActiveLineInfo(),this.DrawEverything()}),this.AttributesListener(this,0,"active_idx",t=>{this.getActiveLineInfo(),this.DrawEverything()})}getActiveLineInfo(){this.pointArr=this.all_lines[this.active_idx].CounterPoint,this._pointArr=[],this.pointArr.forEach((t,i)=>{t&&i>this.pointArr_offset&&this._pointArr.push(t)}),this._pointArr=this.TransToCanvasWH(this._pointArr),this.pointNum=this.pointArr[0][1]}clearCurrentLine(){this.all_lines[this.active_idx].CounterPoint=[[0,20]],this.all_lines[this.active_idx].Scale=0,this.getActiveLineInfo(),this.DrawEverything()}DrawScale(){let t=Math.floor(this.scale/1e4*this.width),i=Math.floor(this.scale/1e4*this.height),e=Math.round(this.width/2-t/2),s=Math.round(this.height/2-i/2);this.DrawRect_Dotted(e,s,t,i,"blue")}TransToCanvasWH(t){return t.map(t=>[Math.round(t[0]/704*this.width),Math.round(t[1]/576*this.height)])}TransToRealWH(t){return t.map(t=>[Math.round(t[0]/this.width*704),Math.round(t[1]/this.height*576)])}MouseDown(t){this.isStartPaint&&(this.pointNum>this._pointArr.length?(this._pointArr.push([t.offsetX,t.offsetY]),2!=t.button&&this.pointNum!=this._pointArr.length||(this.isStartPaint=!1,this._pointArr.pop()),this.SetPointArr(),this.all_lines[this.active_idx].CounterPoint=this.pointArr.concat(),this.DrawEverything()):this.isStartPaint=!1)}MouseMove(t){this.isStartPaint&&this.DrawEverything(t.offsetX,t.offsetY)}MouseLeave(t){if(this.isStartPaint){let i=t.offsetX,e=t.offsetY;i<0&&(i=0),i>this.width&&(i=this.width),e<0&&(e=0),e>this.height&&(e=this.height),this.DrawEverything(i,e)}}SetPointArr(){this.pointArr=r(this.pointArr.slice(0,1).concat(this.TransToRealWH(this._pointArr))),this.CheckPointArr()}CheckPointArr(){this.pointArr.forEach((t,i,e)=>{t[0]>703&&(e[i][0]=703),t[1]>575&&(e[i][1]=575)})}DrawLineArr(t,i=0,e=0,s=this.color,h){t.length<1||(this.ctx.strokeStyle=s,this.ctx.beginPath(),this.ctx.moveTo(t[0][0],t[0][1]),t.forEach((t,i)=>{this.ctx.lineTo(t[0],t[1])}),i>0&&e>0&&this.ctx.lineTo(i,e),this.ctx.stroke())}DrawEverything(t=0,i=0){this.Restore(),this.all_lines.forEach((e,s)=>{let h=s==this.active_idx;if(!this.defaultConfig.showActiveOnly||h){let s=e.CounterPoint,r=[];s.forEach((t,i)=>{t&&i>this.pointArr_offset&&r.push(t)}),r=this.TransToCanvasWH(r);s[0][1];this.DrawLineArr(r,h?t:0,h?i:0,h?this.color:"green",h),h&&(this.scale=e.Scale,this.DrawScale())}})}}i.default={Canvas:n,Config_Temperature_BlackBodyPosition:class extends n{constructor(t,i,e){super(t,i,e),this.AttributesListener(this,{x:-1,y:-1},"testpoint",()=>{this.DrawEverything()})}clearCurrentLine(){this.testpoint={x:-1,y:-1}}MouseDown(t){this.testpoint={x:1e3*t.offsetX/this.width,y:1e3*t.offsetY/this.height},this.DrawEverything()}DrawEverything(t=0,i=0){if(this.Restore(),this.testpoint.x>0&&this.testpoint.y>0){let t=this.testpoint.x*this.width/1e3,i=this.testpoint.y*this.height/1e3;this.DrawArc(t,i,10,2*Math.PI,0,!0,"blue",!0)}}},Config_Line_Retrograde:class extends l{constructor(t,i,e){super(t,i,e),this.isDrawAB=!1,this.point_A=[0,0],this.point_B=[0,0],this.pointArr_offset=2}clearCurrentLine(){super.clearCurrentLine(),this.point_A=[0,0],this.point_B=[0,0],this.isDrawAB=!1,this.DrawEverything()}MouseMove(t){(this.isStartPaint||this.isDrawAB)&&this.DrawEverything(t.offsetX,t.offsetY)}MouseDown(t){this.isStartPaint?this.pointNum>this._pointArr.length?(this._pointArr.push([t.offsetX,t.offsetY]),2!=t.button&&this.pointNum!=this._pointArr.length||(this._pointArr.length<3?this._pointArr=[]:(this.point_A=this.GetCenterPoint(this._pointArr),0===this.point_A[0]&&0===this.point_A[1]?this.isDrawAB=!1:this.isDrawAB=!0),this.isStartPaint=!1),this.SetPointArr(),this.all_lines[this.active_idx].CounterPoint=this.pointArr.concat(),this.DrawEverything(t.offsetX,t.offsetY)):(this.isStartPaint=!1,this.isDrawAB=!0):this.isDrawAB&&(this.point_B=[t.offsetX,t.offsetY],this.isDrawAB=!1,this.SetPointArr(),this.all_lines[this.active_idx].CounterPoint=this.pointArr.concat(),this.DrawEverything())}SetPointArr(){let t=this.TransToRealWH([this.point_A,this.point_B].concat(this._pointArr));this.pointArr=r(this.pointArr.slice(0,1).concat(t)),this.CheckPointArr()}SwapAB(){let t=this.all_lines[this.active_idx].CounterPoint;t.length>=3&&([t[1],t[2]]=[t[2],t[1]]),this.DrawEverything()}DrawLineArr(t,i=0,e=0,s=this.color,h){let r=t.length;r<1||(this.ctx.strokeStyle=s,this.ctx.beginPath(),this.ctx.moveTo(t[0][0],t[0][1]),t.forEach((t,i)=>{this.ctx.lineTo(t[0],t[1])}),this.isStartPaint&&i>0&&e>0&&this.ctx.lineTo(i,e),this.pointNum!=r&&this.isStartPaint&&h||(this.ctx.moveTo(t[r-1][0],t[r-1][1]),this.ctx.lineTo(t[0][0],t[0][1])),this.ctx.stroke())}DrawEverything(t=0,i=0){this.Restore(),this.all_lines.forEach((e,s)=>{let h=s==this.active_idx;if(!this.defaultConfig.showActiveOnly||h){let s=e.CounterPoint,r=[];s.forEach((t,i)=>{t&&i>this.pointArr_offset&&r.push(t)}),r=this.TransToCanvasWH(r);s[0][1];if(this.DrawLineArr(r,h?t:0,h?i:0,h?this.color:"green",h),h){this.scale=e.Scale,this.DrawScale();let h=[0,0],r=[0,0];s.length>this.pointArr_offset&&([h,r]=this.TransToCanvasWH([s[1],s[2]])),!this.isDrawAB&&r[0]&&r[1]?(this.DrawFillText(h[0],h[1],"A","14px Arial","green"),this.DrawFillText(r[0],r[1],"B","14px Arial","green")):this.isStartPaint||this.DrawLine(h[0],h[1],t,i)}}})}},Config_Line_Counter:class extends l{constructor(t,i,e,s=!0){super(t,i,e),this.isWithResult=s,this.pointArr_offset=3-(s?0:1)}DrawEverything(t=0,i=0){this.Restore(),this.all_lines.forEach((e,s)=>{let h=s==this.active_idx;if(!this.defaultConfig.showActiveOnly||h){let s=e.CounterPoint,r=[];s.forEach((t,i)=>{t&&i>this.pointArr_offset&&r.push(t)}),r=this.TransToCanvasWH(r);s[0][1];if(this.DrawLineArr(r,h?t:0,h?i:0,h?this.color:"green",h),h){this.scale=e.Scale,this.DrawScale(),s=e.CounterPoint;let t=this.TransToCanvasWH(s);if(s.length>this.pointArr_offset){if(t[1][0]==t[2][0]&&t[1][1]==t[2][1])return;t[1]=this.OverflowDetail(t[1],10),t[2]=this.OverflowDetail(t[2],10),this.DrawFillText(t[1][0],t[1][1],"A","14px Arial","green"),this.DrawFillText(t[2][0],t[2][1],"B","14px Arial","green"),this.isWithResult&&(t[3]=this.OverflowDetail(t[3],10),this.DrawFillText(t[3][0],t[3][1],"Result","14px Arial","green")),2==e.DetType?this.DrawArrow(t[1][0],t[1][1],t[2][0],t[2][1],30,10,1,!0,"yellow"):1==e.DetType?this.DrawArrow(t[2][0],t[2][1],t[1][0],t[1][1],30,10,1,!1,"yellow"):0==e.DetType&&this.DrawArrow(t[1][0],t[1][1],t[2][0],t[2][1],30,10,1,!1,"yellow")}}}})}SetPointArr(){let t=this.Get_AB_point(this._pointArr),i=[];this.isWithResult&&(i=[this._pointArr[0]]);let e=this.TransToRealWH(t.concat(i,this._pointArr));this.pointArr=r(this.pointArr.slice(0,1).concat(e)),this.CheckPointArr()}SwapAB(){let t=this.all_lines[this.active_idx].CounterPoint;t.length>=3&&([t[1],t[2]]=[t[2],t[1]]),this.DrawEverything()}},Config_Line_Area:class extends l{DrawLineArr(t,i=0,e=0,s=this.color,h=!1){let r=t.length;r<1||(super.DrawLineArr(t,i,e,s,h),this.ctx.beginPath(),this.isStartPaint&&h||(this.ctx.moveTo(t[r-1][0],t[r-1][1]),this.ctx.lineTo(t[0][0],t[0][1]),this.ctx.stroke()))}},Config_Line:l,Config_Rect_Face:class extends n{constructor(t,i,e){super(t,i,e),this.type=0,this.all_rects=[[{x:0,y:0,w:0,h:0}],[{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0}]],this.rectArr=[],this._rectArr=[],this.isPress=!1,this.start_x=0,this.start_y=0,this.isDecimal=!1,this.AttributesListener(this,[],"all_rects",t=>{this.getActiveRectInfo(),this.DrawEverything()}),this.AttributesListener(this,0,"type",t=>{this.getActiveRectInfo(),this.DrawEverything()})}TransToCanvasWH(t){return t.map(t=>{let i={};return i=this.isDecimal?{x:t.x*this.width,y:t.y*this.height,w:t.w*this.width,h:t.h*this.height}:{x:Math.round(t.x/704*this.width),y:Math.round(t.y/576*this.height),w:Math.round(t.w/704*this.width),h:Math.round(t.h/576*this.height)},i})}TransToRealWH(t){return t.map(t=>{let i={};return i=this.isDecimal?{x:t.x/this.width,y:t.y/this.height,w:t.w/this.width,h:t.h/this.height}:{x:Math.round(t.x/this.width*704),y:Math.round(t.y/this.height*576),w:Math.round(t.w/this.width*704),h:Math.round(t.h/this.height*576)},i})}Restore(){super.Restore()}Init(){super.Init()}getActiveRectInfo(){this.rectArr=this.all_rects[this.type].concat(),this._rectArr=h(this.TransToCanvasWH(this.rectArr))}clearCurrentRect(){0==this.type?this.all_rects[0]=[{x:0,y:0,w:0,h:0}]:1==this.type&&(this.all_rects[1]=[{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0}]),this.getActiveRectInfo(),this.DrawEverything()}MouseDown(t){if(this.start_x=t.offsetX,this.start_y=t.offsetY,2==t.button){this._rectArr.some((t,i,e)=>this.start_x>=t.x&&this.start_x<=t.x+t.w&&this.start_y>=t.y&&this.start_y<=t.y+t.h&&(e[i]={x:0,y:0,w:0,h:0},!0));this.all_rects[this.type]=h(this.TransToRealWH(this._rectArr))}else this.isPress=!0,0==this.type&&(this.all_rects[0]=[{x:0,y:0,w:0,h:0}]);this.DrawEverything()}MouseMove(t){this.isPress&&this.DrawEverything(t.offsetX,t.offsetY)}MouseUp(t){this.isPress=!1,0==t.button&&this.DrawEnd(t.offsetX,t.offsetY)}DrawEnd(t,i){[t,i]=this.OverflowDetail([t,i]),this.start_x>t&&([this.start_x,t]=[t,this.start_x]),this.start_y>i&&([this.start_y,i]=[i,this.start_y]);let e=0,s=this._rectArr.some((t,i)=>(e=i,0==t.x&&0==t.y&&0==t.w&&0==t.h));0==this.type?this._rectArr[0]={x:this.start_x,y:this.start_y,w:t-this.start_x,h:i-this.start_y}:s&&(this._rectArr[e]={x:this.start_x,y:this.start_y,w:t-this.start_x,h:i-this.start_y}),this.all_rects[this.type]=h(this.TransToRealWH(this._rectArr)),this.DrawEverything()}DrawRectArr(t,i=this.color,e=0){0!=t.length&&t.forEach((t,s)=>{0!=t.w&&0!=t.h&&(this.DrawRect(t.x,t.y,t.w,t.h,i),1==e&&this.DrawText(t.x+t.w/2,t.y+t.h/2,s+1,this.defaultConfig.font,1==this.type?"red":"green"))})}DrawEverything(t=0,i=0){this.Restore(),this.all_rects.forEach((e,s)=>{if(this.type==s)if(this.isPress&&t>0&&i>0)this.DrawRect(this.start_x,this.start_y,t-this.start_x,i-this.start_y);else{let t=h(this.TransToCanvasWH(e));this.DrawRectArr(t,"red",s)}else{let t=h(this.TransToCanvasWH(e));this.DrawRectArr(t,"green",s)}})}},Config_Rect:class extends n{constructor(t,i,e){super(t,i,e),this.rectNum=2,this.rectArr=[],this._rectArr=[],this.isPress=!1,this.start_x=0,this.start_y=0,this.isDecimal=!1,this.AttributesListener(this,[],"rectArr",t=>{this.Restore(),this._rectArr=[],this.rectNum=this.rectArr.length?this.rectArr.length:1,this.rectArr.forEach((t,i)=>{t&&(this._rectArr[i]={x:t.x,y:t.y,w:t.w,h:t.h},void 0!==t.enable&&(this._rectArr[i].enable=t.enable))}),this._rectArr=h(this.TransToCanvasWH(this._rectArr)),this.DrawRectArr(this._rectArr)})}TransToCanvasWH(t){return t.map(t=>{let i={};return i=this.isDecimal?{x:t.x*this.width,y:t.y*this.height,w:t.w*this.width,h:t.h*this.height}:{x:Math.round(t.x/704*this.width),y:Math.round(t.y/576*this.height),w:Math.round(t.w/704*this.width),h:Math.round(t.h/576*this.height)},void 0!==t.enable&&Object.assign(i,{enable:t.enable}),i})}TransToRealWH(t){return t.map(t=>{let i={};return i=this.isDecimal?{x:t.x/this.width,y:t.y/this.height,w:t.w/this.width,h:t.h/this.height}:{x:Math.round(t.x/this.width*704),y:Math.round(t.y/this.height*576),w:Math.round(t.w/this.width*704),h:Math.round(t.h/this.height*576)},void 0!==t.enable&&Object.assign(i,{enable:t.enable}),i})}Check_rectArr(t){return!!Array.isArray(t)&&t.every(t=>t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.w&&"number"==typeof t.h)}Restore(){super.Restore()}Init(){super.Init()}MouseDown(t){this.start_x=t.offsetX,this.start_y=t.offsetY,2==t.button?(this._rectArr.some((t,i,e)=>this.start_x>=t.x&&this.start_x<=t.x+t.w&&this.start_y>=t.y&&this.start_y<=t.y+t.h&&(e[i]={x:0,y:0,w:0,h:0},void 0!==t.enable&&(e[i].enable=0),this.rectArr[i]=e[i],!0)),this.Restore(),this.DrawRectArr(this._rectArr)):this.isPress=!0}MouseMove(t){this.isPress&&(this.Restore(),this.DrawRect(this.start_x,this.start_y,t.offsetX-this.start_x,t.offsetY-this.start_y),this.DrawRectArr(this._rectArr))}MouseUp(t){this.DrawEnd(t.offsetX,t.offsetY)}MouseLeave(t){this.DrawEnd(t.offsetX,t.offsetY)}DrawEnd(t,i){if(!this.isPress)return;this.isPress=!1,[t,i]=this.OverflowDetail([t,i]),this.start_x>t&&([this.start_x,t]=[t,this.start_x]),this.start_y>i&&([this.start_y,i]=[i,this.start_y]);let e=!!this._rectArr[0]&&void 0!==this._rectArr[0].enable,s=0;this._rectArr.some((t,i)=>(s=i,0==t.x&&0==t.y&&0==t.w&&0==t.h&&(!e||t.enable)))?(this._rectArr[s]={x:this.start_x,y:this.start_y,w:t-this.start_x,h:i-this.start_y},e&&(this._rectArr[s].enable=1)):this.rectNum>this._rectArr.length&&this._rectArr.push({x:this.start_x,y:this.start_y,w:t-this.start_x,h:i-this.start_y}),this.Restore(),this.DrawRectArr(this._rectArr),this._rectArr.forEach((t,i)=>{this.rectArr[i]=t}),this.rectArr=h(this.TransToRealWH(this.rectArr))}DrawRectArr(t,i=this.color){0!=t.length&&t.forEach((t,e)=>{(void 0===t.enable||void 0!==t.enable&&1===t.enable)&&0!=t.w&&0!=t.h&&(this.DrawRect(t.x,t.y,t.w,t.h,i),this.rectNum>1&&this.DrawText(t.x+t.w/2,t.y+t.h/2,e+1))})}},Config_Motion:class extends n{constructor(t,i,e){super(t,i,e),this.isPress=!1,this.start_x=0,this.start_y=0,this.scale=0,this.width_block=Math.ceil(this.width/22*100)/100,this.height_block=Math.ceil(this.height/18*100)/100,this._motionScope=[];for(let t=0;t<18;t++)this._motionScope[t]=new Array(22).fill(0);let s=r(this._motionScope);this.AttributesListener(this,s,"motionScope",t=>{this._motionScope=r(this.motionScope),this.Restore(),this.DrawScale(),this.DrawMotionScope()}),this.AttributesListener(this,0,"scale",t=>{this.Restore(),this.DrawScale(),this.DrawMotionScope()})}DrawScale(){let t=Math.floor(this.scale/1e4*this.width),i=Math.floor(this.scale/1e4*this.height),e=Math.round(this.width/2-t/2),s=Math.round(this.height/2-i/2);this.DrawRect_Dotted(e,s,t,i,"blue")}Check_motionScope(t){return!(!Array.isArray(t)||18!=t.length)&&t.every((function(i){return Array.isArray(t)&&22==i.length}))}Restore(){super.Restore()}Init(){super.Init()}DrawMotionScope(){for(let t=0;t<22;t++)for(let i=0;i<18;i++)this._motionScope[i][t]&&this.DrawRect(this.width_block*t,this.height_block*i,this.width_block,this.height_block)}MouseDown(t){this.isPress=!0,this.start_x=t.offsetX,this.start_y=t.offsetY}MouseMove(t){this.isPress&&(this.Restore(),this.DrawRect(this.start_x,this.start_y,t.offsetX-this.start_x,t.offsetY-this.start_y),this.DrawScale(),this.DrawMotionScope())}MouseUp(t){this.DrawEnd(t.offsetX,t.offsetY)}MouseLeave(t){this.DrawEnd(t.offsetX,t.offsetY)}DrawEnd(t,i){if(!this.isPress)return;this.isPress=!1,[t,i]=this.OverflowDetail([t,i]);let e=Math.round(this.start_x/this.width_block),s=Math.round(this.start_y/this.height_block),h=Math.round(t/this.width_block),o=Math.round(i/this.height_block);e>h&&([e,h]=[h,e]),s>o&&([s,o]=[o,s]);for(let t=e;t<h;t++)for(let i=s;i<o;i++)this._motionScope[i][t]=1;this.Restore(),this.DrawMotionScope(),this.motionScope=r(this._motionScope)}},SmartRuleAndResultShow:class extends n{constructor(t,i,e){super(t,i,e)}DrawTempMapArea(t){let{xLoffset:i,xRoffset:e,yToffset:s,yBoffset:h,SrcW:r,SrcH:o}=t,n=i,a=e,l=s,c=h;n<0&&(n=0),n>r&&(n=r),a<0&&(a=0),a>r&&(a=r),l<0&&(l=0),l>o&&(l=o),c<0&&(c=0),c>o&&(c=o);let f=n/r,u=l/o,w=(r-a)/r,_=(o-c)/o;this.DrawRect(f*this.width,u*this.height,(w-f)*this.width,(_-u)*this.height,"green")}DrawSmart(t,i,e){Array.isArray(t)&&t.forEach((t,s)=>{if(i=t.draw_color||i,t.arrow&&t.arrow.length&&t.arrow.forEach(t=>{this.DrawLine(t[0].x*this.width,t[0].y*this.height,t[1].x*this.width,t[1].y*this.height,i)}),t.points&&t.points.length&&(this.ctx.strokeStyle=i,this.ctx.beginPath(),this.ctx.moveTo(t.points[0].x*this.width,t.points[0].y*this.height),t.points.forEach(t=>{this.ctx.lineTo(t.x*this.width,t.y*this.height)}),t.begin_end_lineto&&this.ctx.lineTo(t.points[0].x*this.width,t.points[0].y*this.height),this.ctx.stroke()),t.rect){let s=i,h=t.hasOwnProperty("result_type")&&-1!=t.result_type;if(t.hasOwnProperty("liveness")&&(s=t.liveness?"green":"red"),t.hasOwnProperty("temp_enable")){if(e&&e.draw_extrainfo){let i=t.temp,{DetectTempAreaMappingInfo:e}=window.app.$store.getters.temperature;if(e){1==e.TempUnit&&(i=1.8*i+32)}let s=""+i.toFixed(1),h="green";if(t.is_alarm&&(h="red"),s.length>0){let i=t.rect.x*this.width,e=t.rect.w*this.width*5/(3*s.length),r=t.rect.y*this.height-e,o=t.rect.w*this.width,n=this.height/20;if(e<=n){e=n;let h=this.MeasureText(s,e+"px Bold SimSun Arial").width;r=t.rect.y*this.height-e,i-=(h-o)/2,o=h}this.DrawFillRect(i,r,o,e,"rgba(229,229,231,0.6)"),this.DrawFillText(i,r,s,e+"px Bold SimSun Arial",h)}}1==t.facemask?s="red":2==t.facemask&&(s="green")}else if(t.hasOwnProperty("helmet_status"))s=0==t.helmet_status?"red":"#FFFF00";else if(t.hasOwnProperty("id")&&t.hasOwnProperty("score")){if(e&&e.draw_extrainfo){let i=`ID:${t.id} SCORE:${t.score}`,e="green";if(i.length>0){let s=t.rect.x*this.width,h=t.rect.w*this.width*5/(3*i.length),r=t.rect.y*this.height-h,o=t.rect.w*this.width,n=this.height/20;if(h<=n){h=n;let e=this.MeasureText(i,h+"px Bold SimSun Arial").width;r=t.rect.y*this.height-h,s-=(e-o)/2,o=e}this.DrawFillRect(s,r,o,h,"rgba(229,229,231,0.6)"),this.DrawFillText(s,r,i,h+"px Bold SimSun Arial",e)}}}else if(t.hasOwnProperty("id")&&t.hasOwnProperty("is_tracked")){if(e&&e.draw_extrainfo){let i="id:"+t.id,e="green";if(i.length>0){let s=t.rect.x*this.width,h=t.rect.w*this.width*5/(3*i.length),r=t.rect.y*this.height-h,o=t.rect.w*this.width,n=this.height/20;if(h<=n){h=n;let e=this.MeasureText(i,h+"px Bold SimSun Arial").width;r=t.rect.y*this.height-h,s-=(e-o)/2,o=e}this.DrawFillRect(s,r,o,h,"rgba(229,229,231,0.6)"),this.DrawFillText(s,r,i,h+"px Bold SimSun Arial",e)}}1==t.is_tracked&&(s="red")}h&&(i=0==t.result_type?"#8B00FF":1==t.result_type?"#FF7F00":t.draw_color||i),this.DrawRect(t.rect.x*this.width,t.rect.y*this.height,t.rect.w*this.width,t.rect.h*this.height,s)}if(t){let i="";t.real_rate_enable&&(i+=`Flow Rate: ${t.real_count}/${t.rate_alarm_num} `),t.total_enable&&(i+=`Total Rate: ${t.total_count}/${t.total_alarm_num}`),i.length&&this.DrawFillText(t.point.x*this.width,t.point.y*this.height,i,"14px Bold Arial")}})}},SearchBar:class extends n{constructor(t,i,e){super(t,i,e),this.timeVec=[3600,3e3,2400,1800,1200,900,600,60],this.index=0,this.st_begin_x=0,this.playSpeed=1,this.playOffsetX=0,this.isDrawCurrentTime=!1,this.currentOffsetX=0,this.isPress=!1,this.currentTime=0,this.scal=86400/this.width,this.scaleRate=[this.scal,5*this.scal/6,2*this.scal/3,this.scal/2,this.scal/3,this.scal/4,this.scal/6,this.scal/60],this.AttributesListener(this,[],"records",()=>{this.Restore(),this.DrawScale()})}Resize(t,i){this.width=t,this.height=i,this.scal=86400/this.width,this.scaleRate=[this.scal,5*this.scal/6,2*this.scal/3,this.scal/2,this.scal/3,this.scal/4,this.scal/6,this.scal/60],this.Restore(),this.DrawScale()}Restore(){super.Restore(),this.DrawLine(0,60,this.width,60,"white")}Init(){super.Init(),this.Restore(),this.DrawScale()}DoubleClick(t){this.playOffsetX=t.offsetX,this.currentTime=this.xToSec(this.playOffsetX)+this.st_begin_x;let i=0;for(let t=0;t<this.records.length;t++){let e=this.records[t],h=e[3]-e[4],r=s(e[1]+h),o=s(e[2]+h),n=3600*r.hour+60*r.min+r.sec,a=3600*o.hour+60*o.min+o.sec;if(this.currentTime<a){i=this.currentTime<n?e[1]:Math.floor(this.currentTime)-n+e[1];break}}this.Dbclick({hms:this.currentTime,utcsecs:i})}MouseDown(t){this.isPress=!0,this.isDrawCurrentTime=!1,this.currentOffsetX=t.offsetX}MouseMove(t){if(this.isPress){this.st_begin_x+=Math.floor(this.xToSec(this.currentOffsetX-t.offsetX)),this.st_begin_x<0&&(this.st_begin_x=0);let i=86400-this.width*this.scaleRate[this.index];this.st_begin_x>i&&(this.st_begin_x=i)}else this.isDrawCurrentTime=!0;this.currentOffsetX=t.offsetX,this.DrawScale()}MouseUp(t){this.isPress=!1}MouseLeave(t){this.isDrawCurrentTime=!1}DrawCurrentTime(){let t=Math.floor(this.xToSec(this.currentOffsetX))+this.st_begin_x,i=Math.floor(t/3600),e=Math.floor((t-3600*i)/60),s=Math.ceil(t-3600*i-60*e);this.DrawText(this.currentOffsetX,30,`${o(i)}:${o(e)}:${o(s)}`)}Clear(){this.Restore()}Play(t){for(let i=0;i<this.records.length;i++){let e=this.records[i],h=e[3]-e[4];if(t<=e[2]){let i=s(t+h);t=3600*i.hour+60*i.min+i.sec;break}}t&&(this.currentTime=t,this.playOffsetX=this.secToX(this.currentTime-this.st_begin_x)),this.DrawScale()}MouseWheel(t){t.preventDefault();let i=t.deltaY,e=this.xToSec(t.offsetX);this.index+=i<0?1:-1,this.index<0&&(this.index=0),this.index>7&&(this.index=7);let s=this.xToSec(t.offsetX),h=this.st_begin_x+(e-s),r=86400-this.xToSec(this.width);h<0?this.st_begin_x=0:h>r?this.st_begin_x=r:(this.st_begin_x+=e-s,this.DrawScale())}DrawScale(){let t=this.st_begin_x/3600,i=(this.st_begin_x-3600*t)/60,e=0,h=3600*t+60*i+(this.st_begin_x-3600*t-60*i),r=h%this.timeVec[this.index];for(0!=r&&(e+=this.secToX(this.timeVec[this.index]-r),h+=this.timeVec[this.index]-r),this.Restore();h<=86400&&e<=this.width;){this.DrawLine(e,50,e,60,"gray");let t=Math.floor(h/3600),i=Math.floor((h-3600*t)/60);this.DrawText(e,45,`${o(t)}:${o(i)}`),e+=this.secToX(this.timeVec[this.index]),h+=this.timeVec[this.index]}for(let t=0;t<this.records.length;t++){let i=this.records[t],r=s(i[1]+i[3]-i[4]),o=s(i[2]+i[3]-i[4]),n=3600*r.hour+60*r.min+r.sec,l=3600*o.hour+60*o.min+o.sec,c=this.secToX(n-h)+e,f=this.secToX(l-n);c<0&&(f+=c,c=0),c+f>this.width&&(f=this.width-c),f<1&&(f=1),this.DrawFillRect(c,65,f,30,a[i[0]]||"rgb(255,255,255)")}this.isDrawCurrentTime&&this.DrawCurrentTime(),this.DrawLine(this.playOffsetX,50,this.playOffsetX,110,"green")}xToSec(t){return t*this.scaleRate[this.index]}secToX(t){return t/this.scaleRate[this.index]}},Live3d_PrivacyMask:class extends n{constructor(t,i,e,s){super(t,i,e),this.isPress=!1,this.start_x=0,this.start_y=0,this._ob=s,this._ob||console.error("非法的observer,无法 发送事件消息")}Restore(){super.Restore()}Init(){super.Init()}MouseDown(t){this.isPress=!0,this.start_x=t.offsetX,this.start_y=t.offsetY,console.log(this.start_x,this.start_y)}MouseMove(t){this.isPress&&(this.Restore(),this.DrawRect(this.start_x,this.start_y,t.offsetX-this.start_x,t.offsetY-this.start_y))}MouseUp(t){this.DrawEnd(t.offsetX,t.offsetY)}MouseLeave(t){this.DrawEnd(t.offsetX,t.offsetY)}DrawEnd(t,i){console.log(t,i),this.isPress&&(this.isPress=!1,[t,i]=this.OverflowDetail([t,i]),this._ob&&(console.log([this.start_x,this.start_y,t-this.start_x,i-this.start_y]),this._ob.emit("ipc_ptzdome_3d_privacymask_msg",{left:this.start_x/this.width,top:this.start_y/this.height,right:t/this.width,bottom:i/this.height})),this.Restore())}}}}]).default}));
//# sourceMappingURL=canvas_alpha.js.map